extends ./base.jade

block vars
   - var pageTitle = "Team 4618 - Login"
   - var navTitle = "Home"
   - var navColor = "red"
   - var backgroundurl = "/assets/general_background.png"
   
block style
   style.
      .block {
         width: 80%;
         background-color: #{navColor};
         margin-left: 5%;
         margin-top: 25px;
         margin-bottom: 25px;
         border: white solid thick;
         outline: black solid thin;
      }
      
block content
   p Welcome! This is the Team 4618 Server
   #scout.block
      p Team ID: #[input(type="text", id="team_box" autocomplete="off")]
      button(id="scout_search_button") Search
   #login.block
      p Login
      p Username: #[input(type="text", id="username_box" autocomplete="off")]
      p Password: #[input(type="password", id="password_box" autocomplete="off")]
      button(id="login_button") Login
      
block script
   script.
      function tryLogin()
      {
         var login_creds = {
                              username: $('#username_box').val(),
                              password: $('#password_box').val()
                           };
         socket.emit('login', login_creds);
         $('#username_box').val('');
         $('#password_box').val('');
      }
      
      function enterHook(e)
      {
         if(e.keyCode == 13)
         {
            $(this).trigger("enterKey");
         }
      }
      
      $(document).ready(function()
      {
         $('#scout_search_button').bind("click", function()
         {
            var team = parseInt($('#team_box').val());
            
            if(!isNaN(team))
            {
               window.location.href = ("/scout " + team);   
               $('#search_box').val('');
            }
            else
            {
               $('#search_box').val("Invalid Team Number!");
            }
         });
         
         $('#username_box').keyup(enterHook);
         $('#password_box').keyup(enterHook);
         
         $('#login_button').bind("click", tryLogin);
         $('#username_box').bind("enterKey", tryLogin);
         $('#password_box').bind("enterKey", tryLogin);
      });